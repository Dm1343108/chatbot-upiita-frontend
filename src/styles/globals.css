/* ===========================
   Chatbot UPIITA — Layout 100% pantalla, sin huecos
=========================== */

:root{
  --bg-main:#0b1220;
  --bg-card:#111827;
  --bg-bubble-bot:#1e293b;
  --bg-bubble-user:#4338ca;
  --text-primary:#e2e8f0;
  --text-secondary:#94a3b8;
  --accent:#6366f1;
  --accent-light:#818cf8;

  --radius:18px;
  --shadow:0 10px 40px rgba(0,0,0,.35);
  --font:"Inter",system-ui,sans-serif;

  --fs:clamp(.95rem, .25vw + .9rem, 1.05rem);
  --fs-sm:clamp(.82rem, .2vw + .78rem, .92rem);

  /* ancho ideal de la tarjeta en pantallas grandes */
  --card-max:1280px;
  --card-min:900px;

  /* mapas (miniatura) */
  --map-h-mobile:56svh;
  --map-h-tablet:68svh;
  --map-h-desktop:80svh;
}

*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}

html, body { height: 100%; }
body{
  /*sin padding exterior: el card ocupa TODO */
  padding: 0;
  background: var(--bg-main);
  color: var(--text-primary);
  font-family: var(--font);
  font-size: var(--fs);

  /*no permitas scroll de la página; scrollea el contenido interno */
  overflow: hidden;

  /* centra horizontalmente el card grande */
  display: flex;
  justify-content: center;
}

/* ===== Tarjeta del chat (ocupa toda la altura) ===== */
.chat-card{
  /* ancho fluido; 100% en móvil, centrado con max-width en pantallas grandes */
  width: min(96vw, var(--card-max));
  max-width: var(--card-max);

  /*SIEMPRE pantalla completa */
  height: 100dvh;

  background: var(--bg-card);
  border-radius: 0;           /* sin bordes en móvil; se ajusta luego */
  box-shadow: none;           /* sin sombra en móvil; se ajusta luego */

  display:flex;
  flex-direction:column;
  overflow:hidden;           /* el scroll vive en .chat-scroll */
}

/* Laptop/Desktop: bordes y sombra agradables */
@media (min-width: 1024px){
  .chat-card{
    width: clamp(var(--card-min), 86vw, var(--card-max));
    border-radius: 18px;
    box-shadow: var(--shadow);
  }
}

/* ===== Header ===== */
.chat-header{
  display:flex;justify-content:space-between;align-items:center;
  padding: 12px clamp(14px, 2vw, 22px);
  background:#0f172a;border-bottom:1px solid #1e293b;
}
.brand{display:flex;align-items:center;gap:10px}
.brand-logo{
  width:36px;height:36px;border-radius:10px;background:var(--accent);
  display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700
}
.chat-header h1{font-size:clamp(1rem, .35vw + .95rem, 1.2rem);font-weight:700}
.chat-header p{font-size:var(--fs-sm);color:var(--text-secondary)}
.header-actions{display:flex;gap:8px}
.ghost,.primary{
  border:none;cursor:pointer;font-weight:600;border-radius:10px;
  min-height:40px;padding:8px 14px;transition:.2s
}
.ghost{background:transparent;color:var(--text-primary)}
.ghost:hover{background:#1e293b}
.primary{background:linear-gradient(90deg,var(--accent),var(--accent-light));color:#fff}
.primary:hover{opacity:.92}

/* ===== Timeline (único área que scrollea) ===== */
.chat-scroll{
  flex:1;                /* ocupa todo entre header e input */
  min-height:0;          /* importante para que flex permita scroll */
  overflow-y:auto;       /* scrollea solo el timeline */
  padding: clamp(14px, 1.8vw, 24px);
  display:flex;flex-direction:column;gap:12px;
  scroll-behavior:smooth;
}

/* ===== Burbujas ===== */
.row{display:flex;align-items:flex-end}
.row.bot{justify-content:flex-start}
.row.user{justify-content:flex-end}
.bubble{
  background:var(--bg-bubble-bot);
  border-radius:16px;padding:14px 16px;line-height:1.5;
  max-width: 100%; word-break: break-word;
}
.bubble.user{background:var(--bg-bubble-user);color:#fff}
.time{font-size:.8rem;color:var(--text-secondary);margin-top:6px;text-align:right}

/* Bloque con botones ocupa todo el ancho */
.row.bot .bubble.bot{width:100%;padding-block:16px}

/* ===== Botones (grid adaptable) ===== */
.qr-grid{
  display:grid;gap:14px;width:100%;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
}
.qr-btn{
  background:#182436;color:var(--text-primary);
  border:1px solid #2b3a4f;border-radius:999px;
  padding:14px 16px;text-align:center;font-weight:700;
  white-space:normal;line-height:1.25;transition:.2s;width:100%;min-height:48px
}
.qr-btn:hover{background:var(--accent);border-color:var(--accent);color:#fff}

/* ===== Input (pegado abajo, sin huecos) ===== */
.chat-input{
  display:flex;gap:12px;
  padding:12px clamp(14px,2vw,22px);
  background:#0f172a;border-top:1px solid #1e293b;

  /* sin hueco exterior; el card ya mide 100dvh */
  padding-bottom:12px;
}
@media (max-width: 640px){
  .chat-input{
    /* solo en móviles respeta safe-area (barra inferior) */
    padding-bottom: calc(12px + env(safe-area-inset-bottom, 0px));
  }
}
.textarea{
  flex:1;background:#182436;color:var(--text-primary);
  border:none;border-radius:14px;padding:12px 14px;
  font-size:16px;resize:none;outline:none;height:46px;line-height:1.45
}
.send{
  background:linear-gradient(90deg,var(--accent),var(--accent-light));color:#fff;
  border:none;border-radius:14px;padding:0 18px;cursor:pointer;font-weight:700;
  min-height:46px;transition:.2s
}
.send:hover{opacity:.92}

/* ===== Lightbox ===== */
.lightbox{
  position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(4px);
  display:flex;align-items:center;justify-content:center;z-index:60
}
.lightbox-content{
  background:var(--bg-card);border-radius:16px;box-shadow:var(--shadow);
  width:min(96vw, 1200px);height:min(96vh, 92vh);
  display:flex;flex-direction:column;overflow:hidden
}
.viewer-body{
  flex:1;overflow:hidden;padding:0;display:flex;align-items:center;justify-content:center;background:#000
}
.lightbox-img{
  width:100%;height:100%;
  object-fit:contain;border-radius:12px;border:1px solid rgba(255,255,255,.08)
}
.lightbox-actions{
  display:flex;justify-content:flex-end;gap:10px;padding:10px;
  border-top:1px solid rgba(255,255,255,.08);background:rgba(0,0,0,.08)
}

/* ===== Estado vacío ===== */
.empty-state{flex:1;display:flex;justify-content:center;align-items:center;text-align:center;color:var(--text-secondary)}

/* ===========================
   Mapas en el chat — sin hueco y responsivos
=========================== */

/* Contenedor del mapa (miniatura) */
.media-wrap{
  width: 100%;
  margin: 10px auto 0;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  background: #000;
  border: 1px solid #2b3a4f;
  border-radius: 12px;

  /* elimina hueco por línea base */
  padding: 0; line-height: 0;
}

/* Base (desktop): ancho moderado, alto controlado */
.media-wrap img.chat-media,
.media-wrap img.media{
  display: block;
  width: 72%;
  height: auto;
  max-height: var(--map-h-desktop);
  object-fit: contain;
  border-radius: 12px;
  cursor: zoom-in;
}

/*Móvil: ocupa casi todo el ancho y limita alto */
@media (max-width: 640px){
  .media-wrap img.chat-media,
  .media-wrap img.media{
    width: 96%;
    max-height: var(--map-h-mobile);
  }
}

/* Tablet: más grande y cómodo */
@media (min-width: 641px) and (max-width: 1023px){
  .media-wrap img.chat-media,
  .media-wrap img.media{
    width: 90%;
    max-height: var(--map-h-tablet);
  }
}